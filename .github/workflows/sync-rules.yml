name: Sync Rules
on:
  schedule: [cron: '5 * * * *']
  workflow_dispatch:
  push: {branches: [main]}

jobs:
  sync:
    runs-on: ubuntu-latest
    permissions: {contents: write}
    steps:
      - uses: actions/checkout@v4
      - run: |
          curl -sL https://raw.githubusercontent.com/hagezi/dns-blocklists/main/adblock/pro.mini.txt > rules/pro.mini.txt
          curl -sL https://raw.githubusercontent.com/hagezi/dns-blocklists/main/adblock/tif.medium.txt > rules/tif.medium.txt
          curl -sL https://raw.githubusercontent.com/hagezi/dns-blocklists/main/adblock/spam-tlds.txt > rules/spam-tlds.txt
          echo "âœ… Rules synced"
        shell: bash
      - run: |
          git config user.name "bot"
          git config user.email "bot@github.com"
          git add rules/
          git diff --quiet && echo "No changes" && exit 0
          git commit -m "ðŸ¤– Update rules $(date +%Y-%m-%d)"
          git push
        shell: bash
